{
  "hash": "f12b9739fbe2840ed7b4b70d8b515eca",
  "result": {
    "markdown": "---\ntitle: TidyTuesday - Big Mac Index\ndate: '2021-01-06'\ncategories:\n  - TidyTuesday\n  - Visualization\nimage: graph.png\n---\n\n::: {.cell}\n::: {.cell-output-display}\n```{=html}\n<blockquote class=\"twitter-tweet\" data-width=\"550\" data-lang=\"en\" data-dnt=\"true\" data-theme=\"light\"><p lang=\"en\" dir=\"ltr\">For my first <a href=\"https://twitter.com/hashtag/TidyTuesday?src=hash&amp;ref_src=twsrc%5Etfw\">#TidyTuesday</a> post, I&#39;ve attempted a comparison of the 2015 to 2020 movement of the Big Mac index : <a href=\"https://t.co/AOGOvt3ve5\">https://t.co/AOGOvt3ve5</a><a href=\"https://twitter.com/hashtag/RStats?src=hash&amp;ref_src=twsrc%5Etfw\">#RStats</a> <a href=\"https://twitter.com/hashtag/dataviz?src=hash&amp;ref_src=twsrc%5Etfw\">#dataviz</a> <a href=\"https://twitter.com/hashtag/r4ds?src=hash&amp;ref_src=twsrc%5Etfw\">#r4ds</a> <a href=\"https://twitter.com/hashtag/ggplot2?src=hash&amp;ref_src=twsrc%5Etfw\">#ggplot2</a> <a href=\"https://t.co/1TZTpAo3s0\">pic.twitter.com/1TZTpAo3s0</a></p>&mdash; Rahul (@rsangole) <a href=\"https://twitter.com/rsangole/status/1346894661973987330?ref_src=twsrc%5Etfw\">January 6, 2021</a></blockquote>\n\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(ggplot2)\nlibrary(ggrepel)\nlibrary(ggdark)\nlibrary(ggtext)\n\nbigmac <- data.table::fread(\"big-mac.csv\")\n\nbigmac_us_dat <- bigmac %>%\n  dplyr::filter(currency_code == \"USD\") %>%\n  dplyr::select(date, bigmac_us_price_USD = local_price)\n\nbigmac_value_dat <- bigmac %>%\n  dplyr::select(date,\n                currency_code,\n                name,\n                bigmac_local_price = local_price,\n                dollar_ex) %>%\n  dplyr::left_join(\n    y = bigmac_us_dat,\n    on = date\n  )\n\nbigmac_value_dat <- bigmac_value_dat %>%\n  dplyr::mutate(\n    bigmac_ex_rate = bigmac_local_price / bigmac_us_price_USD,\n    valuation =  1 - bigmac_ex_rate / dollar_ex\n    )\n\nbigmac_value_dat %>%\n  dplyr::select(date, name, valuation) %>%\n  dplyr::filter(date %in% as.Date(c(\"2020-07-01\", \"2015-07-01\"))) %>%\n  tidyr::pivot_wider(names_from = date, values_from = valuation) %>%\n  janitor::clean_names() %>%\n  dplyr::mutate(movement = x2020_07_01 - x2015_07_01,\n                bw = ifelse(x2020_07_01 > x2015_07_01, \"Valuation worse in 5 years\", \"Valuation better in 5 years\"),\n                bw = ifelse(name == \"United States\", \"ref\", bw),\n                bw = factor(bw, levels = c(\"Valuation worse in 5 years\", \"Valuation better in 5 years\", \"ref\")),\n                name = forcats::fct_reorder(name, x2020_07_01),\n                label_pos = ifelse(bw == \"Valuation worse in 5 years\",\n                                   x2020_07_01 + 0.02,\n                                   x2020_07_01 - 0.02)) %>%\n  dplyr::arrange(movement)  %>%\n  tidyr::drop_na()-> to_plot\n\nglimpse(to_plot)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 42\nColumns: 6\n$ name        <fct> Sri Lanka, Czech Republic, India, Ukraine, Thailand, Singa…\n$ x2015_07_01 <dbl> 0.45409867, 0.40840293, 0.61738434, 0.67662319, 0.33855599…\n$ x2020_07_01 <dbl> 0.359218095, 0.334283358, 0.557499169, 0.619139345, 0.2857…\n$ movement    <dbl> -0.094880571, -0.074119572, -0.059885175, -0.057483840, -0…\n$ bw          <fct> Valuation better in 5 years, Valuation better in 5 years, …\n$ label_pos   <dbl> 0.33921810, 0.31428336, 0.53749917, 0.59913935, 0.26574757…\n```\n:::\n:::\n\n::: {.cell .column-page layout-align=\"center\"}\n\n```{.r .cell-code}\nto_plot %>%\n  ggplot(aes(y = name, color = bw)) +\n  geom_hline(yintercept = 3,\n             color = \"gray80\",\n             size = 0.3) +\n  geom_vline(xintercept = 0,\n             color = \"gray90\",\n             size = 0.2) +\n  geom_point(aes(x = x2015_07_01), color = \"gray70\", size = 1.5) +\n  geom_segment(aes(x = x2020_07_01, xend = x2015_07_01, yend = name), color = \"gray70\") +\n  geom_point(\n    data = to_plot %>% filter(name != \"United States\"),\n    mapping = aes(x = x2020_07_01),\n    size = 2\n  ) +\n  geom_text(\n    data = to_plot %>% filter(bw == \"Valuation worse in 5 years\"),\n    mapping = aes(x = label_pos, y = name, label = name),\n    size = 3.5,\n    hjust = 0,\n    show.legend = FALSE\n  ) +\n  geom_text(\n    data = to_plot %>% filter(bw == \"Valuation better in 5 years\"),\n    mapping = aes(x = label_pos, y = name, label = name),\n    size = 3.5,\n    hjust = 1,\n    show.legend = FALSE\n  ) +\n  geom_label(\n    data = data.frame(\n      x = c(-0.5, -0.25, 0, 0.25, 0.50, 0.75),\n      y = c(3, 3, 3, 3, 3, 3)\n    ),\n    mapping = aes(\n      x = x,\n      y = y,\n      label = scales::label_percent()(x)\n    ),\n    size = 2.8,\n    color = \"gray30\",\n    hjust = 0.5,\n    label.size = 0,\n    label.padding = unit(0.2, \"lines\")\n  ) +\n  annotate(\n    geom = \"curve\",\n    xend = 0.674,\n    yend = 42.5,\n    x = 0.674 + 0.04,\n    y = 44,\n    curvature = .3,\n    arrow = arrow(length = unit(2, \"mm\")),\n    color = \"#e76f51\"\n  ) +\n  annotate(\n    geom = \"text\",\n    x = 0.674 + 0.04 + 0.006,\n    y = 44,\n    label = \"2020\",\n    hjust = \"left\",\n    size = 3.4,\n    color = \"#e76f51\"\n  ) +\n  annotate(\n    geom = \"curve\",\n    xend = 0.563,\n    yend = 42.5,\n    x = 0.563 + 0.04,\n    y = 44,\n    curvature = .3,\n    arrow = arrow(length = unit(2, \"mm\")),\n    color = \"gray70\"\n  ) +\n  annotate(\n    geom = \"text\",\n    x = 0.563 + 0.04 + 0.006,\n    y = 44,\n    label = \"2015\",\n    hjust = \"left\",\n    size = 3.4,\n    color = \"gray70\"\n  ) +\n  theme_minimal() +\n  theme(\n    axis.text = element_blank(),\n    panel.grid.major = element_blank(),\n    panel.grid.minor = element_blank(),\n    axis.title.x = element_text(color = \"#264653\")\n  ) +\n  theme(\n    legend.position = c(0.14, 0.2),\n    legend.title = element_blank(),\n    legend.text = element_text(color = \"#264653\", size = 9.5)\n  ) +\n  scale_color_manual(values = c(\"#e76f51\", \"#2a9d8f\")) +\n  scale_x_continuous(\n    labels = scales::label_percent(),\n    breaks = c(-0.5, -0.25, 0, 0.25, 0.5, 0.75),\n    expand = c(0, 0.1)\n  ) +\n  scale_y_discrete(expand = c(-0.1, 7)) +\n  annotate(\n    geom = \"text\",\n    x = -0.3,\n    y = 44,\n    label = \"Over Valued\",\n    size = 3.4,\n    color = \"#264653\"\n  ) +\n  annotate(\n    geom = \"text\",\n    x = 0.3,\n    y = 44,\n    label = \"Under Valued\",\n    size = 3.4,\n    color = \"#264653\"\n  ) +\n  labs(x = \"Big Mac Exchange Rate Valuation\", y = \"\")\n```\n\n::: {.cell-output-display}\n![](2021-01-06-tidytuesday-big-mac-index_files/figure-html/unnamed-chunk-3-1.png){fig-align='center' width=672}\n:::\n:::\n",
    "supporting": [
      "2021-01-06-tidytuesday-big-mac-index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../../site_libs/twitter-widget-0.0.1/widgets.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}