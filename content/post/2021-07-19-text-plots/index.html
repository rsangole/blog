---
title: Enhance ETL pipeline monitoring with text plots
author: Rahul
date: '2021-07-19'
slug: text-plots
categories:
  - R
tags:
  - visualization
  - docker
output: 
  blogdown::html_page:
    toc: true
---

<script src="{{< blogdown/postref >}}index_files/header-attrs/header-attrs.js"></script>

<div id="TOC">
<ul>
<li><a href="#whats-the-distribution-of-a-variable">What’s the distribution of a variable?</a></li>
<li><a href="#counts-of-a-factor">Counts of a factor?</a></li>
<li><a href="#boxplots">Boxplots</a></li>
<li><a href="#time-series-plots">Time series plots</a></li>
</ul>
</div>

<p>I often use data ETL pipeline scripts cron-jobed on text-only interfaces (be it Jenkins, or cron-jobed in shell). While I print descriptive stats to keep tabs on ETL runs, I’ve found <a href="https://cran.r-project.org/web/packages/txtplot/index.html"><code>{txtplot}</code></a> adds a higher level of fidelity in my logfiles. <a href="https://www.rdocumentation.org/collaborators/name/Bjoern%20Bornkamp">Bjoern Bornkamp</a>’s package offers a simple and effective way to enhance my logfiles.</p>
<p>Will I use them to visualize my data? No. Are they useful tokeep an eye on your pipelines and quickly diagnose issues? Yes, I’ve been able to diagnose more than a few data quality spills very quickly because I had these rudimentary plots in my logfiles.</p>
<p>Some examples…</p>
<div id="whats-the-distribution-of-a-variable" class="section level3">
<h3>What’s the distribution of a variable?</h3>
<pre class="r"><code>dat &lt;- dplyr::starwars %&gt;% 
  mutate(across(where(is.character), forcats::fct_infreq))

dat %&gt;%
  tidyr::drop_na(height) %&gt;% 
  pull(height) %&gt;% 
  txtdensity(., xlab = &quot;starwars: height distribution&quot;, width = 70, height = 12, pch = &quot;o&quot;)</code></pre>
<pre><code>##       +-----------+--------------+-------oo----+-------------+-------+
##  0.02 +                                oooooo                        +
##       |                               oo    oo                       |
## 0.015 +                              oo      o                       +
##       |                             oo        o                      |
##  0.01 +                             o         oo                     +
##       |                            o           oo                    |
## 0.005 +         ooo              oo              ooo                 +
##       |  oooooooo oooooooooooooooo                 ooooooooo   ooo   |
##     0 +-----------+--------------+-------------+-----------ooooo-----+
##                  100            150           200           250       
##                        starwars: height distribution</code></pre>
</div>
<div id="counts-of-a-factor" class="section level3">
<h3>Counts of a factor?</h3>
<pre class="r"><code>txtbarchart(dat$sex, width = 70, height = 12, pch = &quot;x&quot;)</code></pre>
<pre><code>##    +--x--------------+--------------+--------------+--------------+--+
## 60 +  x                                                              +
##    |  x                                                              |
##    |  x                                                              |
## 40 +  x                                                              +
##    |  x                                                              |
## 20 +  x              x                                               +
##    |  x              x                                               |
##    |  x              x              x              x              x  |
##  0 +--x--------------x--------------x--------------x--------------x--+
##       1              2              3              4              5   
## Legend: 1=male, 2=female, 3=none, 4=hermaphroditic, 5=NA&#39;s</code></pre>
</div>
<div id="boxplots" class="section level3">
<h3>Boxplots</h3>
<pre class="r"><code>txtboxplot(dat$height, dat$mass, width = 70, height = 12)</code></pre>
<pre><code>##  0            50            100           150           200           
##  |-------------+-------------+-------------+-------------+-----------|
##                                                 +---+--+              
## 1                                       --------|   |  |---------     
##                                                 +---+--+              
##                  +-----+-+                                            
## 2     -----------|     | |----------                                  
##                  +-----+-+                                            
##      +                                                                
## 3    |                                                                
##      +                                                                
## Legend: 1=dat$height, 2=dat$mass, 3=12</code></pre>
</div>
<div id="time-series-plots" class="section level3">
<h3>Time series plots</h3>
<pre class="r"><code>txtplot(y = LakeHuron, x = 1875:1972, width = 70, height = 12, xlab = &quot;year&quot;, ylab = &quot;level&quot;)</code></pre>
<pre><code>##   582 +--*--+----------+-----------+----------+-----------+----------+
##       |      ****                                                    |
##   581 +  *****  *                       *            **              +
## l 580 +    *     ** *     ***    **                  * *       ***   +
## e 579 +           **  ****   * * ***     *      ****   *  *     *    +
## v     |             ** *     **    **   *       *       *  *  **     |
## e 578 +                       * *    * *     **     *   *  *  *      +
## l 577 +                               *  ** ** *         ** **       +
##       |                                    *                         |
##   576 +-----+----------+-----------+----------+-----------+-*--------+
##           1880       1900        1920       1940        1960          
##                                    year</code></pre>
<p>ACF plots, though I’ve not used these in production yet.</p>
<pre class="r"><code>txtacf(sunspot.year, width = 70, height = 12)</code></pre>
<pre><code>##   1 +--*--------------+-------------+--------------+--------------+--+
##     |  *                                                             |
##     |  *  *                                                          |
##     |  *  *                         *  *                             |
## 0.5 +  *  *  *                   *  *  *  *                          +
##     |  *  *  *                   *  *  *  *                       *  |
##     |  *  *  *                 * *  *  *  *  *                    *  |
##   0 +  *  *  *  *  *  *  *  *  * *  *  *  *  *  *  *  *  *  *  *  *  +
##     |              *  *  *  *                   *  *  *  *  *        |
##     |              *  *  *                         *  *  *           |
##     +--+--------------*-------------+--------------+--------------+--+
##        0              5            10             15             20</code></pre>
</div>
